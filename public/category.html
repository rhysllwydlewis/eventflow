<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Browse Packages â€” EventFlow</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="/assets/css/eventflow-17.0.0.css">
  <link rel="stylesheet" href="/assets/css/utilities.css">
  <link rel="stylesheet" href="/assets/css/components.css">
  <link rel="stylesheet" href="/assets/css/animations.css">
  <meta name="description" content="Browse packages by category on EventFlow.">
  <link rel="icon" href="/favicon.svg">
</head>
<body>
<header class="header" role="banner">
  <div class="container header-inner">
    <a class="brand" href="/" aria-label="EventFlow home">
      <span class="logo" aria-hidden="true"></span>
      <span class="brand-text">EventFlow</span>
    </a>
    <div class="header-actions">
      <nav class="nav nav-inline" aria-label="Quick navigation">
        <a href="/start.html" class="nav-link nav-main">Plan</a>
        <a href="/suppliers.html" class="nav-link nav-main">Suppliers</a>
        <a href="/auth.html" class="nav-link nav-main nav-main-login">Log in</a>
      </nav>
      <button id="notification-bell" class="icon-button" type="button" aria-label="Notifications" style="display:none;">
        <span class="notification-icon">ðŸ””</span>
        <span class="notification-badge" style="display:none;">0</span>
      </button>
      <button id="burger" class="nav-toggle" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
      </button>
      </div>
  </div>
  <nav class="nav nav-menu" aria-label="Primary navigation">
    <a href="/start.html">Plan an Event</a>
    <a href="/suppliers.html">Suppliers</a>
    <a href="/plan.html">My Plan</a>
    <a href="/for-suppliers.html">For Suppliers</a>
    <a href="/faq.html">FAQ</a>
    <a href="/settings.html">Settings</a>
    <a href="/auth.html" id="nav-auth">Sign in</a>
    <a href="#" id="nav-dashboard" style="display:none">Dashboard</a>
    <a href="#" id="nav-signout" style="display:none">Sign out</a>
  </nav>
</header>
<script src="/assets/js/auth-nav.js" defer></script>
<script src="/assets/js/components.js" defer></script>
<script src="/assets/js/animations.js" defer></script>
<script src="/assets/js/notifications.js" defer></script>

<main>
  <section class="section section--muted">
    <div class="container">
      <div id="category-hero-section"></div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div id="category-breadcrumb" style="margin-bottom: 16px; font-size: 0.9rem; color: var(--color-text-secondary, #6c757d);">
        <a href="/" style="text-decoration: none; color: inherit;">Home</a> / 
        <span id="breadcrumb-category">Category</span>
      </div>
      <h1 id="category-title">Loading...</h1>
      <p id="category-description" class="lead"></p>
      <div id="package-list-container"></div>
    </div>
  </section>
</main>

<footer class="footer" role="contentinfo">
  <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
    <div><strong>EventFlow</strong><br><span class="small">Event planning made simple.</span></div>
    <div class="version">Version: <span id="ef-version-label">loadingâ€¦</span></div>
    <div class="small">
      <a href="/credits.html">Credits</a> Â·
      <a href="/contact.html">Contact</a> Â·
      <a href="/terms.html">Terms</a> Â·
      <a href="/privacy.html">Privacy</a>
    </div>
  </div>
</footer>

<script src="/assets/js/app.js"></script>
<script src="/assets/js/components/package-list.js"></script>
<script>
  window.__EF_PAGE__ = 'category';

  document.addEventListener('DOMContentLoaded', () => {
    // Get category slug from URL
    const urlParams = new URLSearchParams(window.location.search);
    const slug = urlParams.get('slug');

    if (!slug) {
      document.getElementById('category-title').textContent = 'Category not found';
      document.getElementById('package-list-container').innerHTML = 
        '<div class="package-empty-state"><p>Invalid category. <a href="/">Return home</a></p></div>';
      return;
    }

    // Load category and packages
    fetch(`/api/categories/${slug}`)
      .then(res => {
        if (!res.ok) {
          throw new Error('Category not found');
        }
        return res.json();
      })
      .then(data => {
        const { category, packages } = data;

        // Update page title and metadata
        document.title = `${category.name} â€” EventFlow`;
        document.getElementById('category-title').textContent = category.name;
        document.getElementById('category-description').textContent = category.description || '';
        document.getElementById('breadcrumb-category').textContent = category.name;

        // Show hero image if available
        if (category.heroImage) {
          const heroSection = document.getElementById('category-hero-section');
          heroSection.innerHTML = `
            <div style="position: relative; border-radius: 12px; overflow: hidden; height: 300px;">
              <img src="${category.heroImage}" alt="${category.name}" 
                   style="width: 100%; height: 100%; object-fit: cover;">
              <div style="position: absolute; bottom: 0; left: 0; right: 0; 
                          background: linear-gradient(to top, rgba(0,0,0,0.7), transparent); 
                          padding: 32px; color: white;">
                <h1 style="margin: 0; font-size: 2.5rem;">${category.icon || ''} ${category.name}</h1>
              </div>
            </div>
          `;
        }

        // Display packages
        if (typeof PackageList !== 'undefined') {
          const packageList = new PackageList('package-list-container', {
            sortFeaturedFirst: true,
          });
          packageList.setPackages(packages || []);
        } else {
          document.getElementById('package-list-container').innerHTML = 
            '<p>Unable to load packages. Please refresh the page.</p>';
        }
      })
      .catch(error => {
        console.error('Error loading category:', error);
        document.getElementById('category-title').textContent = 'Category not found';
        document.getElementById('package-list-container').innerHTML = 
          '<div class="package-empty-state"><p>This category could not be found. <a href="/">Return home</a></p></div>';
      });
  });
</script>
<script src="/assets/js/components/footer-nav.js" defer></script>
<script src="/assets/js/cookie-consent.js" defer></script>
</body>
</html>
