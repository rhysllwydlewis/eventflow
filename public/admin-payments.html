<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Payment Analytics â€” Admin Panel â€” EventFlow</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="/assets/css/eventflow-17.0.0.css">
  <link rel="stylesheet" href="/assets/css/utilities.css">
  <link rel="stylesheet" href="/assets/css/components.css">
  <link rel="stylesheet" href="/assets/css/animations.css">
  <link rel="stylesheet" href="/assets/css/admin.css">
  <link rel="stylesheet" href="/assets/css/admin-enhanced.css">
  <link rel="icon" href="/favicon.svg">
  <script src="/assets/js/admin-shared.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
  <script src="/assets/js/components.js" defer></script>
<script src="/assets/js/admin-navbar.js" defer></script>
</head>
<body class="has-admin-navbar">
<!-- Modern Top Navbar -->
<nav class="admin-top-navbar">
  <div class="admin-navbar-content">
    <!-- Brand -->
    <div class="admin-navbar-brand">
      <a href="/admin.html" class="admin-navbar-logo">EventFlow</a>
      <span class="admin-navbar-title">Admin Panel</span>
    </div>

    <!-- Mobile Hamburger -->
    <button class="admin-hamburger" id="adminHamburger" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Navigation Links -->
    <div class="admin-navbar-nav" id="adminNavbarNav">
      <a href="/admin.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-label">Dashboard</span>
      </a>
      <a href="/admin-users.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-label">Users</span>
      </a>
      <a href="/admin-packages.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ“¦</span>
        <span class="nav-label">Packages</span>
      </a>
      <a href="/admin-photos.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ“¸</span>
        <span class="nav-label">Photos</span>
      </a>
      <a href="/admin-tickets.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ«</span>
        <span class="nav-label">Tickets</span>
      </a>
      <a href="/admin-reports.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ“ˆ</span>
        <span class="nav-label">Reports</span>
      </a>
      <a href="/admin-audit.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-label">Audit</span>
      </a>
      <a href="/admin-homepage.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">Homepage</span>
      </a>
      <a href="/admin-payments.html" class="admin-nav-btn">
        <span class="nav-icon">ğŸ’³</span>
        <span class="nav-label">Payments</span>
      </a>
      <a href="/admin-content.html" class="admin-nav-btn">
        <span class="nav-icon">âœï¸</span>
        <span class="nav-label">Content</span>
      </a>
      <a href="/admin-settings.html" class="admin-nav-btn">
        <span class="nav-icon">âš™ï¸</span>
        <span class="nav-label">Settings</span>
      </a>
    </div>

    <!-- Right Actions -->
    <div class="admin-navbar-actions">
      <!-- Database Status -->
      <div class="db-status-badge db-loading" id="dbStatusBadge" title="Database status">
        <span class="db-status-dot"></span> Loading...
      </div>

      <!-- Refresh Button -->
      <button class="navbar-icon-btn" id="navRefreshBtn" title="Refresh data">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
        </svg>
      </button>

      <!-- User Dropdown -->
      <div class="admin-user-dropdown">
        <button class="admin-user-btn" id="adminUserBtn">
          <div class="admin-user-avatar">A</div>
          <span>Admin</span>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="admin-dropdown-menu" id="adminDropdownMenu">
          <a href="/settings.html" class="admin-dropdown-item">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m4.22-13.22l-4.24 4.24m0 5.96l-4.24 4.24M23 12h-6m-6 0H1m18.78 4.22l-4.24-4.24m-5.96 0l-4.24 4.24"></path>
            </svg>
            Settings
          </a>
          <div class="admin-dropdown-divider"></div>
          <button class="admin-dropdown-item" id="adminLogoutBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Sign Out
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>


<header class="header" role="banner">
    <div class="container header-inner">
      <a class="brand" href="/" aria-label="EventFlow home">
        <span class="logo" aria-hidden="true"></span>
        <span class="brand-text">EventFlow</span>
      </a>
      <div class="header-actions">
        <nav class="nav nav-inline" aria-label="Admin navigation">
          <a href="/admin.html" class="nav-link">Dashboard</a>
          <a href="/admin-users.html" class="nav-link">Users</a>
          <a href="/admin-tickets.html" class="nav-link">Tickets</a>
          <a href="/admin-payments.html" class="nav-link active">Payments</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1>Payment Analytics</h1>
        <button id="adminLogoutBtn" style="padding: 0.5rem 1rem;">Sign out</button>
      </div>

      <div class="note-box">
        <h4>âš ï¸ Note on Google Pay Analytics Limitations</h4>
        <p>
          Due to Google Pay's privacy and security requirements, detailed transaction analytics are limited.
          We capture basic payment metadata (amount, plan, timestamp) but cannot access full payment details
          or customer financial information. This dashboard shows aggregated data based on our subscription
          records and Firebase payment logs.
        </p>
      </div>

      <!-- Stats Overview -->
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Revenue (All Time)</h3>
          <p class="stat-value" id="totalRevenue">Â£0.00</p>
          <p class="stat-change" id="revenueChange">â€”</p>
        </div>
        
        <div class="stat-card">
          <h3>Active Subscriptions</h3>
          <p class="stat-value" id="activeSubscriptions">0</p>
          <p class="stat-change" id="subscriptionChange">â€”</p>
        </div>
        
        <div class="stat-card">
          <h3>Total Transactions</h3>
          <p class="stat-value" id="totalTransactions">0</p>
          <p class="stat-change" id="transactionChange">â€”</p>
        </div>
        
        <div class="stat-card">
          <h3>This Month's Revenue</h3>
          <p class="stat-value" id="monthRevenue">Â£0.00</p>
          <p class="stat-change" id="monthChange">â€”</p>
        </div>
      </div>

      <!-- Charts -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
        <div class="chart-container">
          <h3>Revenue Over Time</h3>
          <canvas id="revenueChart"></canvas>
        </div>
        
        <div class="chart-container">
          <h3>Subscription Plans Distribution</h3>
          <canvas id="plansChart"></canvas>
        </div>
      </div>

      <!-- Filter Bar -->
      <div class="filter-bar">
        <select id="statusFilter">
          <option value="all">All Statuses</option>
          <option value="success">Success</option>
          <option value="pending">Pending</option>
          <option value="failed">Failed</option>
        </select>
        
        <select id="planFilter">
          <option value="all">All Plans</option>
          <option value="pro_monthly">Pro Monthly</option>
          <option value="pro_plus_monthly">Pro+ Monthly</option>
          <option value="pro_yearly">Pro Yearly</option>
          <option value="pro_plus_yearly">Pro+ Yearly</option>
        </select>
        
        <select id="dateFilter">
          <option value="all">All Time</option>
          <option value="7">Last 7 Days</option>
          <option value="30">Last 30 Days</option>
          <option value="90">Last 90 Days</option>
        </select>
        
        <button id="refreshBtn" class="btn-icon" title="Refresh data" style="margin-left: auto;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M23 4v6h-6"></path>
            <path d="M1 20v-6h6"></path>
            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
          </svg>
          Refresh Data
        </button>
      </div>

      <!-- Payments Table -->
      <div class="payments-table">
        <h3>Recent Transactions</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Supplier</th>
                <th>Plan</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Transaction ID</th>
              </tr>
            </thead>
            <tbody id="paymentsTableBody">
              <tr>
                <td colspan="6" style="text-align: center; padding: 2rem; color: #6b7280;">
                  Loading payment data...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer" role="contentinfo">
    <div class="container flex-between">
      <div><strong>EventFlow</strong><br><span class="small">Event planning made simple.</span></div>
      <div class="version">Version: v17.0.0</div>
      <div class="small">
        <a href="/blog.html">Blog</a> Â·
        <a href="/credits.html">Credits</a> Â·
        <a href="/contact.html">Contact</a> Â·
        <a href="/legal.html">Legal Hub</a>
      </div>
    </div>
  </footer>

  <script src="/assets/js/components/footer-nav.js" defer></script>
  <script type="module" src="/assets/js/pages/admin-payments-init.js"></script>
</body>
</html>
