# EventFlow Environment Variables

# PRODUCTION DEPLOYMENT CHECKLIST
# ================================
# ‚ö†Ô∏è  Before deploying to production, you MUST complete ALL required steps:
#
# REQUIRED (App will fail without these):
# ‚òê 1. Generate strong JWT_SECRET: openssl rand -base64 32
# ‚òê 2. Set NODE_ENV=production
# ‚òê 3. Set BASE_URL to your actual domain (https://your-app.railway.app)
# ‚òê 4. ‚≠ê Configure MongoDB Atlas - see detailed steps below
#      ‚Üí Create free account at https://cloud.mongodb.com/
#      ‚Üí Set MONGODB_URI with your actual connection string
#      ‚Üí See MONGODB_SETUP_SIMPLE.md for step-by-step guide
#
# RECOMMENDED (For full functionality):
# ‚òê 5. Configure email service (AWS SES, SendGrid, or SMTP)
# ‚òê 6. Set EMAIL_ENABLED=true for email delivery
# ‚òê 7. Set FROM_EMAIL to match your verified domain
#
# IMPORTANT: If MongoDB is not configured correctly, you will see:
# ‚Ä¢ "Failed to connect to MongoDB: Invalid scheme..." error
# ‚Ä¢ 502 Bad Gateway errors
# ‚Ä¢ "connection refused" errors
#
# üìö Troubleshooting 502 errors? See: MONGODB_SETUP_SIMPLE.md
# üìö Full deployment guide: DEPLOYMENT_GUIDE.md

# ============================================
# REQUIRED: Security
# ============================================
# Generate a strong secret: openssl rand -base64 32
JWT_SECRET=your_super_long_random_secret

# Owner account password (for admin@event-flow.co.uk)
# This account is protected from deletion and has full admin privileges
# IMPORTANT: Set a strong password for production deployments
OWNER_PASSWORD=Admin123!

# ============================================
# Database Configuration
# ============================================
# ‚ö†Ô∏è  PRODUCTION DEPLOYMENT: MongoDB Atlas is configured as the primary database
# 
# Priority order (when multiple databases are configured):
#   1. MongoDB (if MONGODB_URI is set) - PRIMARY
#   2. Firebase Firestore (if FIREBASE_PROJECT_ID is set)
#   3. Local JSON files (development fallback only)
#
# For detailed setup instructions, see: MONGODB_SETUP_SIMPLE.md
# Quick start: https://github.com/rhysllwydlewis/eventflow#mongodb-setup

# ============================================
# MongoDB Atlas (Cloud Database) - RECOMMENDED FOR PRODUCTION
# ============================================
# 
# ‚ö†Ô∏è  IMPORTANT: Replace with your MongoDB Atlas connection string for production
# The example below is a working connection string format.
#
# How to get your connection string:
# 1. Create free account at https://cloud.mongodb.com/
# 2. Create a cluster (free M0 tier available)
# 3. Add a database user (Database Access ‚Üí Add New Database User)
# 4. Whitelist your IP (Network Access ‚Üí Add IP Address ‚Üí Allow Access from Anywhere for testing)
# 5. Click "Connect" on your cluster ‚Üí "Connect your application"
# 6. Copy the connection string and paste it below
# 7. Replace <username>, <password>, and <cluster-name> with your actual values
#
# Example connection string format:
# mongodb+srv://myusername:myStrongPass123@cluster0.abcde.mongodb.net/eventflow?retryWrites=true&w=majority
#
# For this EventFlow instance, use the provided connection string:
MONGODB_URI=mongodb+srv://rhysllwydlewis_db_user:PFURJbvrEVlZ1Jvj@cluster0.ex621ix.mongodb.net/eventflow?retryWrites=true&w=majority

# ============================================
# Local MongoDB - DEVELOPMENT/TESTING ONLY
# ============================================
# This is automatically used in development if MONGODB_URI is not set
# ‚ö†Ô∏è  NOTE: Localhost URIs are rejected in production for security
MONGODB_LOCAL_URI=mongodb://localhost:27017/eventflow

# Database name (optional, defaults to 'eventflow')
MONGODB_DB_NAME=eventflow

# ============================================
# Server Configuration
# ============================================
PORT=3000
NODE_ENV=development

# Your website URL (required for verification emails)
# Local: http://localhost:3000
# Production: https://event-flow.co.uk
# NOTE: Using localhost in production will trigger a warning
BASE_URL=http://localhost:3000

# Trust proxy setting (for Railway, Heroku, or other reverse proxies)
# Set to 'true' when running behind a proxy/load balancer to enable proper IP detection
# Required for rate limiting and X-Forwarded-For/X-Forwarded-Proto headers
# Default: 'false' for local dev, automatically 'true' on Railway (RAILWAY_ENVIRONMENT exists)
TRUST_PROXY=false

# ============================================
# EMAIL CONFIGURATION (Required for verification emails)
# ============================================

# Enable/disable email sending
# In production, this defaults to 'true'
# In development, this defaults to 'false' (emails saved to /outbox folder)
EMAIL_ENABLED=true

# From address for outgoing emails
FROM_EMAIL=no-reply@eventflow.com

# --- Option 1: Mailgun (Recommended for production) ---
# Mailgun email service - Professional transactional email delivery
# Get started: https://www.mailgun.com (EU region by default)
# Sign up for free tier and get your API key and domain

# Your Mailgun API key (found in Mailgun dashboard under API Keys)
MAILGUN_API_KEY=pubkey-2821845c6a90a3ec96a734687de541f6

# Your verified Mailgun domain (e.g., mg.yourdomain.com or sandbox domain for testing)
MAILGUN_DOMAIN=mg.yourdomain.com

# Mailgun API base URL (defaults to EU region: https://api.eu.mailgun.net)
# For US region, use: https://api.mailgun.net
MAILGUN_BASE_URL=https://api.eu.mailgun.net

# Sender email address for Mailgun (must be from your verified domain)
# Can be same as FROM_EMAIL or override it
MAILGUN_FROM=no-reply@mg.yourdomain.com

# Application base URL (used for verification and unsubscribe links in emails)
# Local: http://localhost:3000
# Production: https://your-app.railway.app
APP_BASE_URL=http://localhost:3000

# Optional: Secret for unsubscribe token generation (defaults to JWT_SECRET)
# Used to generate secure HMAC-SHA256 tokens for unsubscribe links
# If not set, will use JWT_SECRET as fallback
# UNSUBSCRIBE_SECRET=your-separate-secret-for-unsubscribe-tokens

# --- Option 2: AWS SES (Alternative for production) ---
# AWS Simple Email Service - Professional email delivery
# Get started: https://aws.amazon.com/ses/
AWS_SES_REGION=eu-west-2
AWS_SES_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
# Override FROM_EMAIL if using custom MAIL FROM domain
# FROM_EMAIL=no-reply@event-flow.co.uk

# --- Option 3: SendGrid (Alternative) ---
# Get a free API key from https://sendgrid.com
# Then just set this ONE variable - everything else is automatic:
SENDGRID_API_KEY=SG.your-sendgrid-api-key-here

# --- Option 4: Custom SMTP Server ---
# If not using Mailgun, AWS SES or SendGrid, configure these instead:
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-app-password

# ============================================
# OPTIONAL FEATURES
# ============================================

# Firebase Configuration (for cloud storage and real-time features)
# Get these from your Firebase project settings
FIREBASE_API_KEY=AIzaSyAbFoGEvaAQcAvjL716cPSs1KDMkriahqc
FIREBASE_AUTH_DOMAIN=eventflow-ffb12.firebaseapp.com
FIREBASE_PROJECT_ID=eventflow-ffb12
FIREBASE_STORAGE_BUCKET=eventflow-ffb12.firebasestorage.app
FIREBASE_MESSAGING_SENDER_ID=253829522456
FIREBASE_APP_ID=1:253829522456:web:3fae1bcec63932321bcf6d
FIREBASE_MEASUREMENT_ID=G-JRT11771YD

# Firebase Admin SDK (for backend access to Firestore)
# Option 1: Use Project ID only (works with Application Default Credentials)
# FIREBASE_PROJECT_ID=eventflow-ffb12

# Option 2: Use Service Account JSON (for production)
# Download from Firebase Console > Project Settings > Service Accounts
# FIREBASE_SERVICE_ACCOUNT_KEY='{"type":"service_account","project_id":"eventflow-ffb12",...}'

# Storage Configuration
# Set to 'local' for development, 's3' for AWS, or 'firebase' for Firebase Storage
STORAGE_TYPE=firebase
LOCAL_UPLOAD_PATH=./public/uploads

# AWS S3 (optional, for cloud photo storage in production)
# If not set, photos are stored locally
AWS_S3_BUCKET=
AWS_S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# Stripe (optional, for Pro subscriptions)
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_SUPPLIER_PRICE_ID=

# OpenAI (optional, for AI planning assistant)
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4-turbo-mini

# Google Maps (optional, for venue maps)
# Get API key from: https://console.cloud.google.com/apis/credentials
# Enable Maps Embed API and Maps JavaScript API
GOOGLE_MAPS_API_KEY=

# ============================================
# NOTES
# ============================================

# For Gmail SMTP:
# 1. Enable 2-factor authentication on your Google account
# 2. Generate an "App Password" at https://myaccount.google.com/apppasswords
# 3. Use that app password as SMTP_PASS

# For SendGrid:
# 1. Sign up at https://sendgrid.com (free tier includes 100 emails/day)
# 2. Create an API key with "Mail Send" permissions
# 3. Add it as SENDGRID_API_KEY above
# 4. Verify your sender email address in SendGrid dashboard

# Testing locally:
# - Set EMAIL_ENABLED=false to test without sending real emails
# - Verification links will be shown in the API response
# - Email files are saved to /outbox folder for inspection
